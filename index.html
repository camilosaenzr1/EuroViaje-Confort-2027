<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EuroPlan 2027 | Mobile Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        #map { height: 300px; width: 100%; border-radius: 1.5rem; z-index: 1; }
        @media (min-width: 1024px) { #map { height: 500px; } }
        .city-card.active { border-color: #2563eb; background-color: #f1f7ff; ring: 2px; }
        .custom-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05); }
    </style>
</head>
<body class="text-slate-900">

<div class="min-h-screen flex flex-col">
    <header class="bg-white border-b p-6 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-extrabold tracking-tighter">EURO<span class="text-blue-600">PLAN</span></h1>
                <p class="text-[10px] uppercase font-bold text-slate-400">Septiembre 2027 | 13 Personas</p>
            </div>
            <div class="text-right">
                <span id="diaCounter" class="bg-slate-100 text-slate-700 text-xs font-bold px-3 py-1 rounded-full">15 D√≠as Libres</span>
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-7xl mx-auto w-full p-4 lg:p-8 grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="lg:col-span-4 space-y-6">
            <div class="bg-white p-6 rounded-3xl custom-shadow space-y-4 border">
                <h2 class="text-sm font-bold uppercase text-slate-400">Configuraci√≥n</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-[10px] font-bold text-slate-500">TRM (COP)</label>
                        <input type="number" id="trm" value="4750" oninput="render()" class="w-full text-lg font-bold border-b-2 outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-slate-500">COMIDA (‚Ç¨/D√≠a)</label>
                        <input type="number" id="meal" value="35" min="25" max="40" oninput="render()" class="w-full text-lg font-bold border-b-2 outline-none focus:border-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-[10px] font-bold text-slate-500">NIVEL CONFORT</label>
                    <select id="conf" onchange="render()" class="w-full mt-2 p-3 bg-slate-50 rounded-xl text-sm font-bold border-none ring-1 ring-slate-100">
                        <option value="1.5">üíé Premium (Vans Privadas)</option>
                        <option value="1.0" selected>‚öñÔ∏è Balanceado (Mix)</option>
                        <option value="0.5">üöá Econ√≥mico (P√∫blico)</option>
                    </select>
                </div>
            </div>

            <div class="bg-white p-6 rounded-3xl custom-shadow border">
                <h2 class="text-sm font-bold uppercase text-slate-400 mb-4">Destinos</h2>
                <div id="cityContainer" class="grid grid-cols-2 lg:grid-cols-1 gap-2">
                    </div>
            </div>
        </div>

        <div class="lg:col-span-8 space-y-6">
            <div id="map" class="custom-shadow border-4 border-white"></div>

            <div class="bg-slate-900 rounded-[2rem] p-8 text-white shadow-2xl relative overflow-hidden">
                <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-6">
                    <div>
                        <p class="text-slate-400 text-sm font-bold uppercase tracking-widest">Inversi√≥n Individual</p>
                        <h3 id="resumenCOP" class="text-4xl md:text-5xl font-black text-blue-400">$ 0</h3>
                        <p id="resumenEUR" class="text-xl text-white/50 italic">‚Ç¨ 0</p>
                    </div>
                    <div id="healthMetric" class="bg-white/10 p-4 rounded-2xl backdrop-blur-md border border-white/10 w-full md:w-auto text-center md:text-left">
                        </div>
                </div>
            </div>

            <div id="itineraryDetail" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                </div>
        </div>
    </main>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const db = [
        { id: 'bcn', n: 'Barcelona', lat: 41.38, lng: 2.17, h: 95, fatigue: 'Bajo', img: 'https://images.unsplash.com/photo-1583422409516-2895a77efded?w=400', d: ["Sagrada Familia", "G√≥tico", "Playa"] },
        { id: 'par', n: 'Par√≠s', lat: 48.85, lng: 2.35, h: 120, fatigue: 'Medio', img: 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?w=400', d: ["Torre Eiffel", "Louvre", "Disney"] },
        { id: 'zrh', n: 'Z√∫rich', lat: 47.37, lng: 8.54, h: 160, fatigue: 'Bajo', img: 'https://images.unsplash.com/photo-1527668752968-14dc70a27c95?w=400', d: ["Lindt Chocolate", "Lago Z√∫rich"] },
        { id: 'rom', n: 'Roma', lat: 41.90, lng: 12.49, h: 110, fatigue: 'Alto', img: 'https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=400', d: ["Coliseo", "Vaticano", "Sorrento"] },
        { id: 'ven', n: 'Venecia', lat: 45.44, lng: 12.31, h: 130, fatigue: 'Muy Alto', img: 'https://images.unsplash.com/photo-1523906834658-6e24ef2386f9?w=400', d: ["G√≥ndola", "San Marcos"] },
        { id: 'lux', n: 'Luxemburgo', lat: 49.61, lng: 6.13, h: 115, fatigue: 'Medio', img: 'https://images.unsplash.com/photo-1563813732-757f49514782?w=400', d: ["Casamatas", "Ciudad Alta"] }
    ];

    let select = [];
    let map = L.map('map', { scrollWheelZoom: false }).setView([48, 10], 4);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
    let markers = [];

    function init() {
        const cont = document.getElementById('cityContainer');
        db.forEach(c => {
            cont.innerHTML += `
                <button onclick="toggle('${c.id}')" id="btn-${c.id}" class="city-card text-left p-3 rounded-xl border-2 border-slate-100 bg-white hover:border-blue-200 transition-all">
                    <p class="font-bold text-sm">${c.n}</p>
                </button>
            `;
        });
        render();
    }

    function toggle(id) {
        const i = select.indexOf(id);
        if(i > -1) select.splice(i, 1);
        else if(select.length < 5) select.push(id);
        else alert("M√°ximo 5 ciudades");
        render();
    }

    function render() {
        const trm = document.getElementById('trm').value || 4750;
        const meal = document.getElementById('meal').value || 35;
        const conf = document.getElementById('conf').value;
        const totalDias = 15;
        const diasC = select.length > 0 ? Math.floor(totalDias / select.length) : 0;
        
        // Limpiar
        markers.forEach(m => map.removeLayer(m));
        markers = [];
        document.querySelectorAll('.city-card').forEach(b => b.classList.remove('active', 'border-blue-500'));
        
        let totalEur = 1100; // Tiquete base
        const itin = document.getElementById('itineraryDetail');
        itin.innerHTML = "";

        select.forEach(sid => {
            const city = db.find(x => x.id === sid);
            document.getElementById('btn-'+sid).classList.add('border-blue-500', 'bg-blue-50');
            
            const costT = 25 * conf;
            totalEur += (city.h + parseInt(meal) + costT) * diasC;

            markers.push(L.marker([city.lat, city.lng]).addTo(map).bindPopup(city.n));

            itin.innerHTML += `
                <div class="bg-white rounded-3xl overflow-hidden border shadow-sm">
                    <img src="${city.img}" class="h-32 w-full object-cover">
                    <div class="p-4">
                        <h4 class="font-bold text-lg">${city.n} <span class="text-blue-500 text-xs">${diasC} D√≠as</span></h4>
                        <p class="text-[10px] text-slate-400 font-bold mt-2 uppercase">Plan Salud: ${city.fatigue}</p>
                        <ul class="text-xs text-slate-500 mt-2 italic">${city.d.map(a => `<li>‚Ä¢ ${a}</li>`).join('')}</ul>
                    </div>
                </div>
            `;
        });

        document.getElementById('resumenCOP').innerText = "$ " + (totalEur * trm).toLocaleString('es-CO');
        document.getElementById('resumenEUR').innerText = "‚Ç¨ " + totalEur.toLocaleString('de-DE');
        
        const km = conf > 1 ? '2-4 km' : (conf < 1 ? '10-14 km' : '6-8 km');
        document.getElementById('healthMetric').innerHTML = `
            <p class="text-[10px] font-black uppercase text-blue-300">Esfuerzo Diario</p>
            <p class="text-lg font-bold">üö∂ ${km}</p>
            <p class="text-[10px] text-slate-400 mt-1">Estimado para 62 a√±os / Beb√©s</p>
        `;
        
        if(select.length > 0) {
            let group = new L.featureGroup(markers);
            map.fitBounds(group.getBounds().pad(0.5));
        }
    }

    window.onload = init;
</script>
</body>
</html>
