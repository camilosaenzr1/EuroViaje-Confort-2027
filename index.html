<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuroPlan 2027 | Luxury Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.3); }
        .city-checkbox:checked + div { border-color: #1e293b; background-color: #f1f5f9; }
        #map { height: 500px; border-radius: 24px; filter: grayscale(20%); }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="text-slate-800">

<div class="flex flex-col lg:flex-row h-screen overflow-hidden">
    
    <aside class="w-full lg:w-96 bg-white border-r p-6 overflow-y-auto custom-scrollbar">
        <div class="mb-8">
            <h1 class="text-2xl font-extrabold tracking-tighter text-slate-900">EURO<span class="text-blue-600">PLAN</span></h1>
            <p class="text-xs text-slate-400 font-bold uppercase tracking-widest">Master Edition 2027</p>
        </div>

        <div class="space-y-6 mb-10">
            <div>
                <label class="text-xs font-bold text-slate-500 uppercase">TRM Euro/COP</label>
                <input type="number" id="trm" value="4750" oninput="render()" class="w-full mt-1 text-lg font-semibold outline-none border-b-2 border-slate-100 focus:border-blue-500 transition">
            </div>

            <div>
                <label class="text-xs font-bold text-slate-500 uppercase">Nivel de Confort</label>
                <select id="confort" onchange="render()" class="w-full mt-1 bg-slate-50 p-3 rounded-xl text-sm font-semibold border-none ring-1 ring-slate-200">
                    <option value="premium">üíé Premium (100% Privado/Uber)</option>
                    <option value="balance" selected>‚öñÔ∏è Balanceado (Mix Vans/Bus)</option>
                    <option value="eco">üöá Explorador (100% P√∫blico)</option>
                </select>
            </div>

            <div>
                <label class="text-xs font-bold text-slate-500 uppercase">Comida diaria: <span id="comidaVal">30</span>‚Ç¨</label>
                <input type="range" id="comida" min="25" max="40" value="30" oninput="render()" class="w-full accent-blue-600">
            </div>
        </div>

        <h2 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest">Seleccionar Destinos</h2>
        <div id="cityList" class="space-y-2"></div>
    </aside>

    <main class="flex-1 overflow-y-auto bg-slate-50 p-6 custom-scrollbar">
        
        <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6">
            <div id="map" class="shadow-xl shadow-slate-200 bg-white"></div>

            <div class="glass-card rounded-[24px] p-8 flex flex-col justify-between shadow-xl bg-white border-none">
                <div>
                    <h2 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6">Desglose de Inversi√≥n Individual</h2>
                    <div id="financialBreakdown" class="space-y-4">
                        </div>
                </div>
                
                <div class="mt-8 pt-6 border-t border-slate-100">
                    <p class="text-sm text-slate-500 font-medium">Total Estimado por Persona</p>
                    <h3 id="totalPersona" class="text-5xl font-black text-slate-900 tracking-tighter">$ 0</h3>
                    <p id="totalGrupo" class="text-blue-600 font-bold mt-2 text-sm uppercase"></p>
                </div>
            </div>
        </div>

        <div id="itineraryContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            </div>
    </main>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const database = [
        { id: 'bcn', name: 'Barcelona', n: 3, h: 90, lat: 41.38, lng: 2.17, img: 'https://images.unsplash.com/photo-1511527661048-7fe73d85e9a4?w=800', 
          days: ["D√≠a 1: Sagrada Familia e Interior (‚Ç¨34)", "D√≠a 2: Park G√ºell y Barrio de Gracia (‚Ç¨10)", "D√≠a 3: Las Ramblas y Barrio G√≥tico (Gratis)"] },
        { id: 'par', name: 'Par√≠s', n: 3, h: 120, lat: 48.85, lng: 2.35, img: 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?w=800',
          days: ["D√≠a 1: Torre Eiffel y Crucero Sena (‚Ç¨37)", "D√≠a 2: Louvre y Jardines (‚Ç¨22)", "D√≠a 3: Disneyland Paris (‚Ç¨105)"] },
        { id: 'rou', name: 'Rouen', n: 1, h: 80, lat: 49.44, lng: 1.09, img: 'https://images.unsplash.com/photo-1590059114771-483584347702?w=800',
          days: ["D√≠a 1: Catedral G√≥tica y Casco Medieval (Gratis)"] },
        { id: 'zrh', name: 'Z√∫rich', n: 2, h: 160, lat: 47.37, lng: 8.54, img: 'https://images.unsplash.com/photo-1515488764276-beab7607c1e6?w=800',
          days: ["D√≠a 1: Museo Chocolate Lindt (‚Ç¨15)", "D√≠a 2: Paseo por el Lago y Casco Antiguo"] },
        { id: 'lux', name: 'Luxemburgo', n: 1, h: 110, lat: 49.61, lng: 6.13, img: 'https://images.unsplash.com/photo-1563813732-757f49514782?w=800',
          days: ["D√≠a 1: Casamatas del Bock (‚Ç¨15) y Ascensor de Cristal"] },
        { id: 'vie', name: 'Viena', n: 2, h: 95, lat: 48.20, lng: 16.37, img: 'https://images.unsplash.com/photo-1516550893923-42d28e5677af?w=800',
          days: ["D√≠a 1: Palacio Sch√∂nbrunn (‚Ç¨25)", "D√≠a 2: Catedral de San Esteban y √ìpera"] },
        { id: 'prg', name: 'Praga', n: 2, h: 75, lat: 50.07, lng: 14.43, img: 'https://images.unsplash.com/photo-1519677100203-ad03822ef294?w=800',
          days: ["D√≠a 1: Castillo de Praga (‚Ç¨18)", "D√≠a 2: Puente de Carlos y Ciudad Vieja"] },
        { id: 'ven', name: 'Venecia', n: 2, h: 130, lat: 45.44, lng: 12.31, img: 'https://images.unsplash.com/photo-1523906834658-6e24ef2386f9?w=800',
          days: ["D√≠a 1: San Marcos y G√≥ndola (‚Ç¨80/barca)", "D√≠a 2: Murano y Burano en Vaporetto (‚Ç¨25)"] },
        { id: 'rom', name: 'Roma', n: 4, h: 105, lat: 41.90, lng: 12.49, img: 'https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800',
          days: ["D√≠a 1: Coliseo y Foro Romano (‚Ç¨22)", "D√≠a 2: Fontana di Trevi y Pante√≥n", "D√≠a 3: Museos Vaticanos (‚Ç¨32)", "D√≠a 4: Pasad√≠a Sorrento (Tren + Mar)"] }
    ];

    let selections = [];
    let map = L.map('map').setView([48.0, 10.0], 4);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
    let markers = [];

    function init() {
        const list = document.getElementById('cityList');
        database.forEach(c => {
            list.innerHTML += `
                <label class="block cursor-pointer">
                    <input type="checkbox" class="city-checkbox hidden" onchange="toggleCity('${c.id}')">
                    <div class="p-4 rounded-2xl border-2 border-slate-100 bg-white transition-all flex justify-between items-center group hover:border-slate-300">
                        <div>
                            <p class="font-bold text-slate-800">${c.name}</p>
                            <p class="text-xs text-slate-400">${c.n} Noches</p>
                        </div>
                        <span class="opacity-0 group-hover:opacity-100 transition text-blue-500">‚ûï</span>
                    </div>
                </label>
            `;
        });
        render();
    }

    function toggleCity(id) {
        const idx = selections.indexOf(id);
        if(idx > -1) selections.splice(idx, 1);
        else selections.push(id);
        render();
    }

    function render() {
        const trm = document.getElementById('trm').value;
        const conf = document.getElementById('confort').value;
        const meal = document.getElementById('comida').value;
        document.getElementById('comidaVal').innerText = meal;

        // Limpiar
        markers.forEach(m => map.removeLayer(m));
        markers = [];
        const itinerary = document.getElementById('itineraryContainer');
        itinerary.innerHTML = "";

        let financial = { hotel: 0, meal: 0, transport: 0, bogota: 1100, activities: 0 };
        let totalDays = 0;

        selections.forEach(sid => {
            const c = database.find(x => x.id === sid);
            totalDays += c.n;
            financial.hotel += c.h * c.n;
            financial.meal += parseInt(meal) * c.n;
            
            // L√≥gica transporte interno por confort
            let tBase = (conf === 'premium') ? 45 : (conf === 'balance' ? 20 : 5);
            financial.transport += tBase * c.n;

            // Marcador
            let marker = L.marker([c.lat, c.lng]).addTo(map).bindPopup(c.name);
            markers.push(marker);

            // Itinerario
            itinerary.innerHTML += `
                <div class="bg-white rounded-3xl overflow-hidden shadow-sm border border-slate-100">
                    <div class="h-32 bg-cover bg-center" style="background-image:url('${c.img}')"></div>
                    <div class="p-6">
                        <h4 class="font-black text-xl mb-4">${c.name}</h4>
                        <div class="space-y-3">
                            ${c.days.map(d => `<p class="text-sm text-slate-600 flex items-start"><span class="mr-2">üìç</span>${d}</p>`).join('')}
                        </div>
                    </div>
                </div>
            `;
        });

        // C√°lculo Caminata
        let km = (conf === 'premium') ? '2-4 km' : (conf === 'balance' ? '5-8 km' : '10-14 km');

        // Render Finanzas
        const totalEurPersona = (financial.hotel + financial.meal + financial.transport + financial.bogota + (selections.length * 30));
        const totalCopPersona = totalEurPersona * trm;

        document.getElementById('financialBreakdown').innerHTML = `
            <div class="flex justify-between text-sm"><span class="text-slate-500">‚úàÔ∏è Tiquete BOG - BCN (Ida/Vuelta)</span><span class="font-bold">‚Ç¨${financial.bogota}</span></div>
            <div class="flex justify-between text-sm"><span class="text-slate-500">üè® Alojamiento (${totalDays} noches)</span><span class="font-bold">‚Ç¨${financial.hotel}</span></div>
            <div class="flex justify-between text-sm"><span class="text-slate-500">üç± Alimentaci√≥n Total</span><span class="font-bold">‚Ç¨${financial.meal}</span></div>
            <div class="flex justify-between text-sm"><span class="text-slate-500">üöê Transporte Interno (${conf})</span><span class="font-bold">‚Ç¨${financial.transport}</span></div>
            <div class="mt-4 p-4 bg-blue-50 rounded-2xl border border-blue-100 flex items-center gap-3">
                <span class="text-2xl">üëü</span>
                <div>
                    <p class="text-xs font-bold text-blue-900 uppercase">Caminata Promedio Diaria</p>
                    <p class="text-sm text-blue-700">${km} por persona</p>
                </div>
            </div>
        `;

        document.getElementById('totalPersona').innerText = "$ " + totalCopPersona.toLocaleString('es-CO');
        document.getElementById('totalGrupo').innerText = "Total Grupo (13 pax): $ " + (totalCopPersona * 13).toLocaleString('es-CO');
    }

    init();
</script>
</body>
</html>
