<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuroConfort Pro 2027</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .city-btn.active { border-color: #2563eb; background-color: #eff6ff; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        #map { height: 350px; border-radius: 1rem; z-index: 10; }
        .monument-card { transition: transform 0.3s; }
        .monument-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body class="bg-gray-100 font-sans">

<div class="max-w-7xl mx-auto p-4 md:p-8">
    <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
        <div>
            <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">EURO<span class="text-blue-600">CONFORT</span> 2027</h1>
            <p class="text-gray-500">Planificaci√≥n inteligente para 13 viajeros</p>
        </div>
        
        <div class="glass p-4 rounded-xl border flex gap-4 shadow-sm">
            <div>
                <label class="block text-xs font-bold text-gray-400 uppercase">Tasa Euro (COP)</label>
                <input type="number" id="trm" value="4750" oninput="actualizar()" class="w-24 font-bold text-blue-600 bg-transparent outline-none">
            </div>
            <div class="border-l pl-4">
                <label class="block text-xs font-bold text-gray-400 uppercase">Comida/D√≠a (‚Ç¨)</label>
                <input type="range" id="comidaRange" min="25" max="40" value="30" oninput="actualizar()" class="w-24">
                <span id="comidaVal" class="text-sm font-bold ml-2">30‚Ç¨</span>
            </div>
        </div>
    </header>

    <section class="mb-8">
        <h2 class="text-sm font-bold text-gray-400 uppercase mb-3">Nivel de Confort en Transporte</h2>
        <div class="flex gap-4">
            <button onclick="setConfort(1.2, 'Premium (100% Uber/Vans)')" class="confort-btn p-3 rounded-lg border bg-white flex-1 hover:bg-blue-50" id="c1">üöê Premium</button>
            <button onclick="setConfort(1.0, 'Balanceado (Mix P√∫blico/Privado)')" class="confort-btn p-3 rounded-lg border bg-white flex-1 hover:bg-blue-50" id="c2">‚öñÔ∏è Balanceado</button>
            <button onclick="setConfort(0.7, 'Econ√≥mico (100% P√∫blico)')" class="confort-btn p-3 rounded-lg border bg-white flex-1 hover:bg-blue-50" id="c3">üöá P√∫blico</button>
        </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="lg:col-span-1 space-y-4">
            <h2 class="font-bold text-gray-700">Selecciona Ciudades</h2>
            <div id="listaCiudades" class="grid grid-cols-1 gap-2"></div>
            
            <div id="map" class="shadow-inner border-2 border-white"></div>
        </div>

        <div class="lg:col-span-2 space-y-6">
            <div class="bg-slate-900 rounded-2xl p-6 text-white shadow-xl flex justify-between items-center">
                <div>
                    <p class="text-slate-400 text-sm">Total por Persona</p>
                    <h3 id="resumenPersona" class="text-4xl font-black text-blue-400">$ 0</h3>
                </div>
                <div class="text-right border-l border-slate-700 pl-6">
                    <p class="text-slate-400 text-sm italic" id="txtConfort">Seleccione nivel...</p>
                    <p class="text-xl font-bold" id="resumenGrupo">$ 0 Total Grupo</p>
                </div>
            </div>

            <div id="detalleRuta" class="space-y-6">
                </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const db = [
        { id: "bcn", nombre: "Barcelona", noches: 3, hotel: 90, lat: 41.3851, lng: 2.1734, clima: "24¬∞C Despejado", img: "https://images.unsplash.com/photo-1583422409516-2895a77efded?auto=format&fit=crop&w=600&q=80", 
          monumentos: [{n: "Sagrada Familia", p: 34}, {n: "Park G√ºell", p: 10}] },
        { id: "par", nombre: "Par√≠s", noches: 3, hotel: 120, lat: 48.8566, lng: 2.3522, clima: "19¬∞C Nublado", img: "https://images.unsplash.com/photo-1502602898657-3e91760cbb34?auto=format&fit=crop&w=600&q=80",
          monumentos: [{n: "Torre Eiffel", p: 20}, {n: "Louvre", p: 22}, {n: "Disney", p: 105}] },
        { id: "zrh", nombre: "Z√∫rich", noches: 2, hotel: 160, lat: 47.3769, lng: 8.5417, clima: "16¬∞C Fresco", img: "https://images.unsplash.com/photo-1527668752968-14dc70a27c95?auto=format&fit=crop&w=600&q=80",
          monumentos: [{n: "Museo Lindt", p: 15}] },
        { id: "rom", nombre: "Roma", noches: 4, hotel: 110, lat: 41.9028, lng: 12.4964, clima: "25¬∞C Soleado", img: "https://images.unsplash.com/photo-1552832230-c0197dd311b5?auto=format&fit=crop&w=600&q=80",
          monumentos: [{n: "Coliseo", p: 22}, {n: "Vaticano", p: 32}] }
    ];

    let seleccion = [];
    let factorConfort = 1.0;
    let map = L.map('map').setView([48.8566, 2.3522], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    let markers = [];

    function init() {
        const list = document.getElementById('listaCiudades');
        db.forEach(c => {
            list.innerHTML += `<button onclick="toggleCity('${c.id}')" id="btn-${c.id}" class="city-btn w-full p-4 bg-white border-2 rounded-xl text-left font-bold text-gray-700 hover:shadow-md transition">${c.nombre} (${c.noches} Noches)</button>`;
        });
    }

    function toggleCity(id) {
        const idx = seleccion.indexOf(id);
        if(idx > -1) seleccion.splice(idx, 1);
        else seleccion.push(id);
        
        document.getElementById('btn-'+id).classList.toggle('active');
        actualizar();
    }

    function setConfort(val, txt) {
        factorConfort = val;
        document.getElementById('txtConfort').innerText = txt;
        actualizar();
    }

    function actualizar() {
        const trm = document.getElementById('trm').value;
        const comida = document.getElementById('comidaRange').value;
        document.getElementById('comidaVal').innerText = comida + "‚Ç¨";
        
        let totalEurPersona = 0;
        const detailCont = document.getElementById('detalleRuta');
        detailCont.innerHTML = "";
        
        // Limpiar Mapa
        markers.forEach(m => map.removeLayer(m));
        markers = [];

        seleccion.forEach(sid => {
            const c = db.find(x => x.id === sid);
            const costoTransporte = 25 * factorConfort;
            const subtotalCiudad = (c.hotel + parseInt(comida) + costoTransporte) * c.noches;
            totalEurPersona += subtotalCiudad;

            // Marcador Mapa
            let m = L.marker([c.lat, c.lng]).addTo(map).bindPopup(c.nombre);
            markers.push(m);

            // Render Detalle
            detailCont.innerHTML += `
                <div class="bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-200">
                    <div class="h-40 bg-cover bg-center" style="background-image: url('${c.img}')">
                        <div class="bg-black/40 h-full p-6 flex justify-between items-end text-white">
                            <div>
                                <h4 class="text-2xl font-bold">${c.nombre}</h4>
                                <p class="text-sm">üå°Ô∏è Clima: ${c.clima} | üåô ${c.noches} Noches</p>
                            </div>
                            <p class="text-xl font-black">‚Ç¨${subtotalCiudad}</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h5 class="text-xs font-bold text-gray-400 uppercase mb-4 tracking-widest">Lugares Sugeridos</h5>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            ${c.monumentos.map(m => `
                                <div class="monument-card bg-gray-50 p-3 rounded-lg border text-center">
                                    <p class="text-sm font-bold text-gray-700">${m.n}</p>
                                    <p class="text-xs text-blue-600">Entrada: ‚Ç¨${m.p}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        });

        const totalPersona = totalEurPersona * trm;
        document.getElementById('resumenPersona').innerText = "$ " + totalPersona.toLocaleString('es-CO');
        document.getElementById('resumenGrupo').innerText = "$ " + (totalPersona * 13).toLocaleString('es-CO');
    }

    init();
</script>
</body>
</html>
